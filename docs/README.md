# 리팩토링

기존의 BaseBall 구조에 MVC 패턴을 적용하고, 유효성 검사에 책임 연쇄 패턴을 적용하고, 게임 개발에서 쓰이는 장면(Scene)이라는 개념을 도입해보았다.

## 기존에 아쉬웠던 부분

**1. 통짜파일**  
 : 모든 소스코드의 내용이 분리되어 있지 않고 App.js 파일 하나에 들어가 있었다.

**2. 뚜렷하게 구분되지 않은 역할들**  
 : 각자가 담당하는 부분들이 서로 뒤엉켜있어서 분리하기가 힘들었고, 알아보기 힘들었다.

**3. 비동기를 사용한 것**  
 : 나의 착각으로 async를 사용한 것,,

**4. 하드코딩**  
 : 변경이 될 수 있을만한 문자열 또는 숫자들을 상수로 선언하지 않고 그대로 썼다.

**5. 순서를 파악하기 힘듦**  
 : 2번의 이유로, 코드가 흐름을 따라가기 쉽지 않아 순서를 파악하기 어려웠다.

## 리팩토링 방향

### MVC 패턴을 사용하자.

MVC 패턴이 뭔지는 알고 있었으나 문제에 적용해본 적이 없다는 것을 깨달았다. 이번 기회에 적용하고 싶었다.

- **Model: 공(Gong)**
  - Gong이라 표현한 이유는 Ball로 하면 게임 용어인 볼과 헷갈릴 것 같아 Gong이라 표현했다.
  - 컴퓨터가 만들어낸 숫자, 유저가 입력한 추측 숫자
- **View: OutputView, InputView**
  - OutputView: 출력을 담당하는 View
  - InputView: 입력을 담당하는 View
- **Controller: 장면(Scene)**

  > **장면(Scene)이란?**  
  >  : 게임 개발에서 이용되는 용어로, 하나의 맵이나 스테이지, 또는 레벨 개념에 해당한다.

  1. 인트로씬: IntroScene
     - 게임 시작 문구를 출력한다.
  2. 정답 생성씬: CreateAnswerScene
     - 정답 숫자를 생성하여 저장한다.
  3. 정답 추측씬: GetNumberScene
     - 유저로부터 추측 숫자를 입력받는다.
  4. 힌트 출력씬: PrintHintScene
     - 유저의 추측 숫자에 대한 힌트를 출력한다.
  5. 재시도 질문씬: GetRetryScene
     - 3스트라이크인 경우 들어오는 씬
     - 새로 게임을 시작할 건지, 게임을 종료할 건지 입력받는다.
  6. 아웃트로씬: OutroScene
     - 게임 종료인 경우 들어오는 씬
     - 게임 종료 문구를 출력하고 종료한다.

  각 씬들을 플레이할 수 있게 하는 Core가 필요하다(GameCore)

## 리팩토링 적용

- **기본적으로 게임을 진행하게 하는 Core를 생성해야 한다.**
  - GameCore를 만들어서 씬들을 관리 및 재생할 수 있게 하였다.
- **Core에서 필요한 씬을 분리해야 한다.**
  - 각 단계별로 씬을 만들었다.
- **Gong 모델을 만들어야 한다.**
  - 입력받은 값에 대해 저장하고 얻고 조작하고 판단하는 역할을 주었다.
- **GameState를 만들어야 한다.**
  - Javascript스럽게, 객체지향이지만 함수형 프로그래밍 같이 게임 진행에 필요한 State는 공통 객체로 두어 사용하였다.
- **유효성 검사 클래스에 책임 연쇄 패턴을 적용해야 한다.**
  - 기존의 검사는 조건이 늘어나면 코드가 상당수 늘어나는데, 책임 연쇄 패턴을 통해 불필요한 로직을 줄이고 코드의 흐름을 한 눈에 파악할 수 있게 하였다.

---

이전의 README

---

## 컴퓨터가 선택할 숫자 3개 정하기

    - 각 숫자는 1~9의 범위
    - 중복 허용 X

## 사용자가 입력한 숫자에 힌트주기

    - 각 경우에 스트라이크, 볼, 낫싱을 리턴
    Ex. 컴퓨터의 수가 425일 때)
        (1) 123을 제시한 경우: 1스트라이크
        (2) 456을 제시한 경우: 1볼 1스트라이크
        (3) 789를 제시한 경우: 낫싱
        (4) 425를 제시한 경우: 3스트라이크

## 사용자가 입력한 숫자 검증

    # 입력 제한사항
        - 숫자
        - 각 숫자는 1~9의 범위
        - 중복 허용 X
        - 길이는 3글자(미만, 초과 X)

    #잘못된 값 입력 시
        - throw 문을 사용해 예외 발생
        - 어플리케이션 종료

## 게임 종료 판별

    - 입력한 값이 3스트라이크인지 아닌지 판별
    - 3스트라이크일 시) "3개의 숫자를 모두 맞히셨습니다! 게임 종료" 문구 출력 후 게임 재시작 질문
    - 3스트라이크가 아닐 시) 계속 진행

## 게임 재시작 질문

    - "게임을 새로 시작하려면 1, 종료하려면 2를 입력하세요." 문구 출력
    - 1 입력 시) 게임 재시작
    - 2 입력 시) 게임 종료
    - 1 또는 2의 입력이 아닐 시) 다시 입력받게 하기
